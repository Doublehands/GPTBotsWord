<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OfficeBuddy</title>
    
    <!-- Office.js 必须加载 -->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    
    <link rel="stylesheet" href="taskpane.css">
</head>

<body>
    <!-- Logo 头部 -->
    <div class="header-logo">
        <img src="hkmalogo2.png" alt="OfficeBuddy Logo" />
        <!-- 头部控制器 - 右上角 -->
        <div class="header-controls">
            <!-- 语言选择器 -->
            <div class="language-selector-container">
                <div class="language-switch-buttons" id="languageSwitchButtons">
                    <!-- 动态生成的语言切换按钮 -->
                </div>
            </div>
            <!-- 设置按钮 -->
            <button class="settings-btn" id="settingsBtn">⚙️</button>
        </div>
    </div>
    
    <!-- 翻译语言选择模态框 -->
    <div class="translate-modal" id="translateModal" style="display: none;">
        <div class="translate-modal-content">
            <div class="translate-modal-header">
                <h3 data-i18n="translate.selectLanguage">选择翻译目标语言</h3>
                <button class="translate-modal-close" id="translateModalClose">&times;</button>
            </div>
            <div class="translate-modal-body">
                <div class="translate-language-options">
                    <button class="translate-lang-btn" data-target-lang="en" data-i18n="lang.english">English</button>
                    <button class="translate-lang-btn" data-target-lang="zh-cn" data-i18n="lang.chinese">中文</button>
                    <button class="translate-lang-btn" data-target-lang="ja" data-i18n="lang.japanese">日本語</button>
                    <button class="translate-lang-btn" data-target-lang="ko" data-i18n="lang.korean">한국어</button>
                    <button class="translate-lang-btn" data-target-lang="hi" data-i18n="lang.hindi">हिन्दी</button>
                    <button class="translate-lang-btn" data-target-lang="th" data-i18n="lang.thai">ไทย</button>
                    <button class="translate-lang-btn" data-target-lang="fr" data-i18n="lang.french">Français</button>
                    <button class="translate-lang-btn" data-target-lang="de" data-i18n="lang.german">Deutsch</button>
                    <button class="translate-lang-btn" data-target-lang="es" data-i18n="lang.spanish">Español</button>
                    <button class="translate-lang-btn" data-target-lang="zh-tw" data-i18n="lang.traditional">繁體中文</button>
                </div>
            </div>
        </div>
    </div>



    <div class="container">
        <!-- 第一个界面：配置和工具选择 -->
        <div id="mainInterface" class="interface-page">
            <!-- Section 1: 主要操作区域 -->
            <div class="section">
                <!-- API Key配置 - 默认隐藏 -->
                <div class="api-key-section" id="apiKeySection" style="display: none;">
                    <div class="section-title api-key" data-i18n="apiKey.title">GPTBots API Key</div>
                    <div class="api-key-container">
                        <div class="api-key-input-wrapper">
                            <img src="GPTBots-blackicon.png" alt="GPTBots" class="api-key-icon" />
                            <input type="password" 
                                   class="api-key-input" 
                                   id="apiKeyInput" 
                                   data-i18n-placeholder="apiKey.placeholder"
                                   placeholder="app-xxxxxxxxxxxxxxxxxxxxxxx"
                                   value="app-cqAuvC3vC7d7LybynuoZdK9D" />
                        </div>
                    </div>
                    
                    <!-- LLM API Key -->
                    <div class="api-key-container">
                        <div class="api-key-input-wrapper no-icon">
                            <input type="password" 
                                   class="api-key-input" 
                                   id="llmApiKeyInput" 
                                   placeholder="LLM API Key"
                                   value="" />
                        </div>
                    </div>
                    
                    <!-- Third-party API Key -->
                    <div class="api-key-container">
                        <div class="api-key-input-wrapper no-icon">
                            <input type="password" 
                                   class="api-key-input" 
                                   id="thirdPartyApiKeyInput" 
                                   placeholder="Third-party API Key"
                                   value="" />
                        </div>
                    </div>
                </div>

                <!-- AI Tools -->
                <div class="section-title ai-tools" data-i18n="skills">技能</div>
                <div class="ai-tools-btns">
                    <button class="ai-tool-btn" data-tool="translate" data-i18n="btn.translate">深度翻译</button>
                    <button class="ai-tool-btn" data-tool="polish" data-i18n="btn.polish">内容润色</button>
                    <button class="ai-tool-btn" data-tool="academic" data-i18n="btn.academic">审批建议</button>
                    <button class="ai-tool-btn" data-tool="summary" data-i18n="btn.summary">总结摘要</button>
                    <button class="ai-tool-btn" data-tool="grammar" data-i18n="btn.grammar">语法修正</button>
                    <button class="ai-tool-btn" data-tool="custom_command" data-i18n="btn.custom_command">自定义指令</button>
                </div>
                
                <!-- 自定义指令输入框 -->
                <div class="custom-command-input-container hidden" id="customCommandInputContainer">
                    <div class="custom-command-input-label">
                        <span data-i18n="custom_command.inputLabel">请描述您的自定义指令</span>
                    </div>
                    <textarea class="custom-command-input-textarea" id="customCommandInputTextarea" 
                              data-i18n-placeholder="custom_command.inputPlaceholder"
                              placeholder=""></textarea>
                </div>
                
                <!-- 自定义需求输入框 -->
                <div class="custom-input-container hidden" id="customInputContainer">
                    <div class="custom-input-label">
                        <span data-i18n="custom.inputLabel">请描述您的具体需求</span>
                    </div>
                    <textarea class="custom-input-textarea" id="customInputTextarea" 
                              data-i18n-placeholder="custom.inputPlaceholder"
                              placeholder="例如：总结要点、修正语法错误、特定格式要求等..."></textarea>
                </div>
                


                <!-- Target Content -->
                <div class="section-title conversation" style="margin-top: 20px;" data-i18n="targetContent">目标内容</div>
                <div class="content-source">
                    <button class="content-source-btn active" data-source="selection" data-i18n="btn.selection">选中文本</button>
                    <button class="content-source-btn" data-source="document" data-i18n="btn.document">整个文档</button>
                </div>

                <!-- 开始处理按钮 -->
                <div class="process-controls" style="margin-top: 20px;">
                    <button class="result-action-btn primary" id="copyBtn">
                        <span data-i18n="btn.start">开始处理</span>
                    </button>
                </div>
                            </div>
        </div>

        <!-- 第二个界面：结果预览和插入选项 -->
        <div id="resultInterface" class="interface-page" style="display: none;">
            <!-- Section 1: 结果预览区域 -->
            <div class="section">
                <div class="section-header">
                    <button class="back-button" id="backBtn">←</button>
                    <div class="section-title result" data-i18n="resultPreview">结果预览</div>
                </div>
                <div class="error-message hidden" id="errorMessage"></div>
                <div class="success-message hidden" id="successMessage"></div>
                <div class="result-box" id="resultBox">
                </div>
            </div>

            <!-- Section 2: 插入选项和按钮 -->
            <div class="section">
                <div class="section-title" data-i18n="insertPosition">生成位置</div>
                <div class="insert-position-btns">
                    <button class="insert-position-btn active" data-position="replace" data-i18n="btn.replace">替换选中文本</button>
                    <button class="insert-position-btn" data-position="append" data-i18n="btn.append">添加至末尾</button>
                    <button class="insert-position-btn" data-position="cursor" data-i18n="btn.cursor">光标位置插入</button>
                    <button class="insert-position-btn" data-position="comment" data-i18n="btn.comment">生成批注</button>
                </div>
                <div class="insert-action-container">
                    <button class="result-action-btn secondary" id="insertBtn">
                        <span data-i18n="btn.insert">插入文档</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="api-config.js"></script>
    <script src="local-proxy-api.js"></script>
    <script src="taskpane.js"></script>
</body>

</html>
